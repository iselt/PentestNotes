+++
title = "Windows ä¿¡æ¯æ”¶é›†"
+++

<https://blog.csdn.net/qq_63844103/article/details/128132052>

## ç³»ç»Ÿä¿¡æ¯

### 1. ç³»ç»Ÿç¨‹åº

| å‘½ä»¤                                                                 | æè¿°                       |
|----------------------------------------------------------------------|----------------------------|
| `net config workstation`                                             | æŸ¥è¯¢ç®€æ˜“ç³»ç»Ÿä¿¡æ¯           |
| `systeminfo`                                                         | æŸ¥è¯¢å…¨éƒ¨å†…å®¹               |
| `wmic qfe get Caption,Description,HotFixID,InstalledOn`              | æŸ¥è¯¢å·²å®‰è£…çš„è¡¥ä¸åˆ—è¡¨       |

> ğŸ“ å…¶ä¸­systeminfoå‘½ä»¤æŸ¥è¯¢å†…å®¹æœ€å…¨ï¼Œä½†å¦‚æœç³»ç»Ÿæ›´æ–°çš„è¡¥ä¸è¾ƒå¤šï¼Œå¯èƒ½ä¼šå¯¼è‡´ååº”ååº”æ—¶é—´è¿‡é•¿ï¼›ä½¿ç”¨ webshell æ‰§è¡Œæ­¤å‘½ä»¤å¯èƒ½ä¼šå› ä¸ºè¶…æ—¶å¯¼è‡´æ— æ³•æ­£å¸¸å›æ˜¾ï¼Œæˆ–å›æ˜¾å†…å®¹é•¿åº¦è¿‡é•¿ï¼Œæ— æ³•å…¨éƒ¨æ˜¾ç¤ºã€‚

### 2. è¿›ç¨‹æœåŠ¡

| å‘½ä»¤                                                                 | æè¿°                                           |
|----------------------------------------------------------------------|------------------------------------------------|
| `tasklist /v`                                                        | æŸ¥è¯¢æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹                             |
| `wmic product get name,version`                                      | æŸ¥è¯¢æ‰€æœ‰å®‰è£…è¿‡çš„è½¯ä»¶åŠç‰ˆæœ¬                     |
| `powershell "Get-WmiObject -class Win32_Product \| Select-Object -Property name,version"` | ä½¿ç”¨ PowerShell æŸ¥è¯¢æ‰€æœ‰å®‰è£…è¿‡çš„è½¯ä»¶åŠç‰ˆæœ¬ï¼Œæ•ˆæœå’Œ wmic ç›¸åŒ |
| `wmic service list brief`                                            | æŸ¥è¯¢å½“å‰æœºå™¨çš„æœåŠ¡ä¿¡æ¯                         |
| `wmic startup get command,caption`                                   | æŸ¥çœ‹å¯åŠ¨é¡¹                                     |
| `schtasks /query /fo LIST /v`                                        | æŸ¥çœ‹ä»»åŠ¡è®¡åˆ’                                   |

Windows è‡ªå¸¦é˜²ç«å¢™åŠç‰¹æ®Šè¿‡æ»¤è§„åˆ™ç­‰ç½‘ç»œè®¿é—®å‡å¯ä½¿ç”¨netshåŠç›¸å…³å‘½ä»¤æŸ¥çœ‹ã€‚

| å‘½ä»¤                                                                 | æè¿°                               |
|----------------------------------------------------------------------|------------------------------------|
| `netsh firewall show config`                                         | æŸ¥çœ‹é˜²ç«å¢™ä¿¡æ¯ï¼Œä½† `firewall` å‘½ä»¤å·²å¼ƒç”¨ï¼Œå¯ä½¿ç”¨ `advfirewall` å‘½ä»¤ä»£æ›¿ |
| `netsh advfirewall firewall show rule name=all`                      | æŸ¥çœ‹é…ç½®è§„åˆ™                       |
| `netsh advfirewall set allprofiles state off\on`                     | å…³é—­é˜²ç«å¢™\å¼€å¯é˜²ç«å¢™              |
| `netsh advfirewall export\import xx.pol`                             | å¯¼å‡º\å¯¼å…¥é…ç½®æ–‡ä»¶                  |
| `netsh advfirewall firewall add rule name=â€deny tcp 139â€³ dir=in protocol=tcp localport=139 action=block` | æ–°å»ºè§„åˆ™é˜»æ­¢TCPåè®®139ç«¯å£         |
| `netsh advfirewall firewall add rule name="Remote Desktop" protocol=TCP dir=in localport=3389 action=allow` | æ–°å»ºè§„åˆ™å…è®¸3389é€šè¿‡é˜²ç«å¢™         |
| `netsh advfirewall firewall delete rule name=Remote Desktop`         | åˆ é™¤åä¸ºRemote Desktopçš„è§„åˆ™       |
| `netsh interface`                                                    | è¿æ¥å®‰å…¨è§„åˆ™é…ç½®ï¼Œå¾ˆå°‘é…ç½®         |

### 3. ç”¨æˆ·ä¿¡æ¯

| å‘½ä»¤                          | æè¿°                           |
|-------------------------------|--------------------------------|
| `whoami`                      | å½“å‰ç”¨æˆ·                       |
| `quser`                       | æŸ¥è¯¢ç™»å½•ç”¨æˆ·ï¼ŒåŒ `query user`  |
| `qwinsta`                     | æŸ¥è¯¢ç™»å½•ç”¨æˆ·ï¼ŒåŒ `query user`  |
| `query user`                  | æŸ¥è¯¢ç™»å½•ç”¨æˆ·                   |
| `query session`               | æŸ¥è¯¢ä¼šè¯                       |
| `query termserver`            | æŸ¥è¯¢è¿œç¨‹æ¡Œé¢ä¸»æœºåˆ—è¡¨           |
| `net accounts`                | æŸ¥è¯¢åŸŸå¯†ç ç­–ç•¥                 |
| `net user`                    | æŸ¥è¯¢æœ¬åœ°ç”¨æˆ·åˆ—è¡¨               |
| `net user "$username"`        | æŸ¥è¯¢æŒ‡å®šç”¨æˆ·                   |
| `net localgroup`              | æŸ¥è¯¢æœ¬åœ°ç”¨æˆ·ç»„åˆ—è¡¨             |
| `net localgroup "$groupname"` | æŸ¥è¯¢æŒ‡å®šç”¨æˆ·ç»„æˆå‘˜             |
| `net group`                   | ä»…åŸŸæ§å¯æ‰§è¡Œï¼ŒæŸ¥è¯¢ç”¨æˆ·ç»„åˆ—è¡¨   |
| `net group "$groupname"`      | ä»…åŸŸæ§å¯æ‰§è¡Œï¼ŒæŸ¥è¯¢ç”¨æˆ·ç»„æˆå‘˜   |

> ğŸ“ quserã€qwinstaå’Œqueryå‘½ä»¤åªå­˜åœ¨äºå…è®¸å®‰è£… RDP æœåŠ¡çš„ä¸»æœºä¸Šï¼Œå®˜æ–¹æè¿°å…¶ä»…å­˜åœ¨äº server 2012 åŠä»¥ä¸Šç‰ˆæœ¬å­˜åœ¨ã€‚å…¶ä¸­query termserverå‘½ä»¤å­˜åœ¨é—®é¢˜ï¼Œæœ¬åœ°æµ‹è¯•æ—¶ä¸æè¿°ä¸¥é‡ä¸ç¬¦ï¼Œæ— æ³•åˆ—å‡ºä¿¡æ¯ã€‚

### 4. æ“ä½œè®°å½•

> cmd å’Œ powershell v3 ä»¥ä¸‹çš„æ“ä½œè®°å½•æ— æ³•é•¿æ—¶é—´ä¿å­˜ï¼Œä»…é™å½“å‰çª—å£ã€‚

| å‘½ä»¤                                      | æè¿°                                     |
|-------------------------------------------|------------------------------------------|
| `Get-History \| Format-List -Property *`  | æŸ¥è¯¢ PowerShell å½“å‰çª—å£å†å²æ“ä½œè®°å½•     |
| `Clear-History`                           | åˆ é™¤ PowerShell å½“å‰çª—å£å†å²æ“ä½œè®°å½•     |
| `Clear-History -Id 3`                     | åˆ é™¤ PowerShell å½“å‰çª—å£æŒ‡å®š ID çš„å†å²æ“ä½œè®°å½• |
| `doskey /h`                               | æŸ¥çœ‹ CMD çš„å†å²æ“ä½œè®°å½•                  |
| `doskey /reinstall`                       | åˆ é™¤ CMD çš„å†å²æ“ä½œè®°å½•                  |

å¯ä»¥é€šè¿‡å‘è¿›ç¨‹å‘é€é”®ç›˜å†…å®¹çš„æ–¹å¼å°†è¿è¡Œä¸­çš„çª—å£å†å²æ“ä½œè®°å½•å¯¼å‡ºã€‚

> powershell v5 ä»¥ä¸Šçš„æ“ä½œå†å²è®°å½•ä¼šç›´æ¥ä¿å­˜åœ¨æŒ‡å®šæ–‡ä»¶ä¸­ã€‚ç›´æ¥æŸ¥çœ‹å³å¯ã€‚

```cmd
# æŸ¥çœ‹ powershell å†å²æ“ä½œè®°å½•ï¼Œpowershell v3ã€v4 ç‰ˆæœ¬éœ€è¦å®‰è£…Get-PSReadlineOptionã€‚

type %appdata%\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt
```

## æ‹“æ‰‘ä¿¡æ¯

## å‡­è¯ä¿¡æ¯
