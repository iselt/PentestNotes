# PHP 文件安全

## 搜索关键字

### 文件上传

- `$_FILES`（固定的全局变量，用于接收上传文件的信息）
- `move_uploaded_file()`（将上传的文件移动到新位置）

### 文件读取

- `file_get_contents()`（将整个文件读入一个字符串）
- `fopen()`（打开文件或者 URL）
- `fread()`（读取文件）
- `fgets()`（从文件指针中读取一行）
- `fgetss()`（从文件指针中读取一行并过滤掉 HTML 标记）
- `fpassthru()`（输出文件指针处的所有剩余数据）
- `readfile()`（读取文件并写入到输出缓冲）
- `include()`（包含并运行指定文件）
- `require()`（包含并运行指定文件）
- `include_once()`（包含并运行指定文件）
- `require_once()`（包含并运行指定文件）
- `file()`（将整个文件读入一个数组中）
- `readfile()`（读取文件并写入到输出缓冲）
- `file_exists()`（检查文件或目录是否存在）
- `is_file()`（判断给定文件名是否为一个正常的文件）

一句话正则搜索：`file_get_contents|fopen|fread|fgets|fgetss|fpassthru|readfile|include|require|include_once|require_once|file|readfile|file_exists|is_file`

### 文件写入

- `file_put_contents()`（将一个字符串写入文件）
- `fopen()`（打开文件或者 URL）
- `fwrite()`（写入文件）
- `fputs()`（写入文件）
- `fputcsv()`（将行格式化为 CSV 并写入文件指针）

一句话正则搜索：`file_put_contents|fopen|fwrite|fputs|fputcsv`

### 文件删除

- `unlink()`（删除文件）
- `rmdir()`（删除目录）

一句话正则搜索：`unlink|rmdir`

### 文件检查操作

- `file_exists()`（检查文件或目录是否存在）
- `is_file()`（判断给定文件名是否为一个正常的文件）
- `is_dir()`（判断给定文件名是否为一个目录）
- `filemtime()`（取得文件修改时间）
- `fileatime()`（取得文件的上次访问时间）
- `filectime()`（取得文件的 inode 修改时间）
- `filesize()`（取得文件大小）
- `filetype()`（取得文件类型）
- `fileperms()`（取得文件的权限）
- `fileowner()`（取得文件的所有者）
- `filegroup()`（取得文件的组）
- `fileinode()`（取得文件的 inode）

## 文件监控

使用脚本监控文件变化，帮助找到文件路径
